/*! homework_10 2020-01-14 */

"use strict";var _get=function e(t,r,o){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);if(void 0===n){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,r,o)}if("value"in n)return n.value;var u=n.get;return void 0!==u?u.call(o):void 0},_createClass=function(){function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}}();function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var User=function(){function n(e,t,r,o){_classCallCheck(this,n),this._surname=e,this._name=t,this._login=r,this._password=o,this.getSurname=function(){return _surname},this.getName=function(){return _name},this.getLogin=function(){return _login},this.getPassword=function(){return _password}}return _createClass(n,[{key:"toString",value:function(){return"<td>"+this._surname+"</td><td>"+this._name+"</td><td>"+this._login+"</td><td>"+this._password+"</td>"}}]),n}(),Worker=function(){function u(e,t,r,o,n){_classCallCheck(this,u);var s=_possibleConstructorReturn(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e,t,r,o));return s._job=n,s.getJob=function(){return _job},s}return _inherits(u,User),_createClass(u,[{key:"toString",value:function(){return _get(u.prototype.__proto__||Object.getPrototypeOf(u.prototype),"toString",this).call(this)+"<td>"+this._job+"</td>"}}]),u}(),user1=new User("Krynitsky","Oleg","KROL","1234"),worker1=new Worker("Miadel","Egor","LOYD","_10_","PE teacher"),users=[];users[0]=user1,users[1]=worker1;var express=require("express"),app=express(),bodyParser=require("body-parser");app.use(bodyParser.urlencoded({extended:!1})),app.get("/",function(e,t){t.sendFile(process.cwd()+"/index.html")}),app.get("/show-user-data",function(e,t){var r='<table style="width: 100%" border="1">';r+="<tr><th>Id</th><th>Surname</th><th>Name</th><th>Login</th><th>Password</th><th>Job</th></tr>";for(var o=0;o<users.length;o++)r+="<tr> <td>"+o+"</td>"+users[o].toString()+"</tr>";t.send(r+'</table><form action="/" method="get"><input type="submit" value="Back"/></form>'),t.end()}),app.post("/submit-user-data",function(e,t){if(""===e.body.Job){var r=new User(e.body.Surname,e.body.Name,e.body.Login,e.body.Password);users[users.length]=r;e.body.Surname,e.body.Name,e.body.Login,e.body.Password;t.redirect("/")}else{var o=new Worker(e.body.Surname,e.body.Name,e.body.Login,e.body.Password,e.body.Job);users[users.length]=o;e.body.Surname,e.body.Name,e.body.Login,e.body.Password,e.body.Job;t.redirect("/")}t.end()}),app.post("/update-user-data",function(e,t){if(Number(e.body.Id)<users.length&&0<=Number(e.body.Id))if(""===e.body.uJob){var r=new User(e.body.uSurname,e.body.uName,e.body.uLogin,e.body.uPassword);users[e.body.Id]=r;e.body.uSurname,e.body.uName,e.body.uLogin,e.body.uPassword;t.redirect("/")}else{var o=new Worker(e.body.uSurname,e.body.uName,e.body.uLogin,e.body.uPassword,e.body.uJob);users[e.body.Id]=o;e.body.uSurname,e.body.uName,e.body.uLogin,e.body.uPassword,e.body.uJob;t.redirect("/")}else t.send('wrong id<form action="/" method="get"><input type="submit" value="Back"/></form>');t.end()}),app.post("/delete-user-data",function(e,t){Number(e.body.dId)<users.length&&0<=Number(e.body.dId)?(users.splice(Number(e.body.dId),1),t.redirect("/")):t.send('wrong id<form action="/" method="get"><input type="submit" value="Back"/></form>'),t.end()});var server=app.listen(5e3,function(){console.log("Node server is running..")});